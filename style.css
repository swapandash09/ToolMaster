:root {
    --font: 'Outfit', sans-serif;
    /* DARK MODE */
    --bg: #0a0a0c; --surface: rgba(255, 255, 255, 0.03); --border: 1px solid rgba(255, 255, 255, 0.08);
    --text: #f9fafb; --text-muted: #a1a1aa;
    --primary: #6366f1; --accent: #8b5cf6;
    --card-bg: #131316; --card-hover: #1c1c21;
    --nav-bg: rgba(10, 10, 12, 0.8);
    --glass: blur(10px);
}
body.light-mode {
    /* PREMIUM LIGHT MODE */
    --bg: #f8faff; --surface: #ffffff; --border: 1px solid #e2e8f0;
    --text: #1e293b; --text-muted: #64748b;
    --primary: #4f46e5; --accent: #6366f1;
    --card-bg: #ffffff; --card-hover: #f1f5f9;
    --nav-bg: rgba(255, 255, 255, 0.8);
    --shadow: 0 4px 20px rgba(0,0,0,0.05);
}

* { margin:0; padding:0; box-sizing:border-box; font-family:var(--font); }
body { background:var(--bg); color:var(--text); transition:background 0.4s ease, color 0.4s ease; min-height:100vh; overflow-x:hidden; }

/* SMOOTH ANIMATION */
.fade-in { animation: fadeIn 0.6s ease-out forwards; opacity: 0; }
@keyframes fadeIn { to { opacity: 1; transform: translateY(0); } from { opacity: 0; transform: translateY(10px); } }

/* AMBIENT ORBS */
.ambient-layer { position:fixed; top:0; left:0; width:100%; height:100%; z-index:-1; overflow:hidden; pointer-events:none; }
.orb { position:absolute; border-radius:50%; filter:blur(90px); opacity:0.3; }
.orb-1 { width:500px; height:500px; background:var(--primary); top:-10%; left:-10%; animation:float 8s ease-in-out infinite alternate; }
.orb-2 { width:400px; height:400px; background:var(--accent); bottom:10%; right:-10%; animation:float 10s ease-in-out infinite alternate-reverse; }
@keyframes float { 0% { transform:translate(0,0); } 100% { transform:translate(30px, 50px); } }

/* NAV */
.glass-nav { padding:18px 0; position:sticky; top:0; z-index:100; background:var(--nav-bg); backdrop-filter:var(--glass); border-bottom:var(--border); }
.nav-content { display:flex; justify-content:space-between; align-items:center; max-width:1200px; margin:0 auto; padding:0 20px; }
.logo { font-size:1.4rem; font-weight:700; display:flex; align-items:center; gap:10px; cursor:pointer; }
.logo-box { width:36px; height:36px; background:var(--primary); color:white; border-radius:10px; display:grid; place-items:center; }
.highlight { color:var(--primary); }
.theme-btn { background:var(--surface); border:var(--border); color:var(--text); width:40px; height:40px; border-radius:12px; cursor:pointer; transition:0.3s; }
.theme-btn:hover { background:var(--primary); color:white; border-color:var(--primary); }

/* HERO */
.hero { text-align:center; padding:80px 20px; }
.status-pill { display:inline-block; padding:6px 14px; background:rgba(99,102,241,0.1); color:var(--primary); border-radius:30px; font-size:0.8rem; font-weight:600; border:1px solid var(--primary); margin-bottom:20px; }
.hero h1 { font-size:3.5rem; line-height:1.1; margin-bottom:30px; letter-spacing:-1px; }
.gradient-text { background:linear-gradient(135deg, var(--primary), var(--accent)); -webkit-background-clip:text; color:transparent; }
.search-box { position:relative; max-width:500px; margin:0 auto; transition:0.3s; }
.search-box i { position:absolute; left:20px; top:50%; transform:translateY(-50%); color:var(--text-muted); }
#search-bar { width:100%; padding:18px 20px 18px 50px; border-radius:16px; background:var(--surface); border:var(--border); color:var(--text); font-size:1rem; outline:none; transition:0.3s; }
#search-bar:focus { border-color:var(--primary); box-shadow:0 0 0 4px rgba(99,102,241,0.1); background:var(--bg); }

/* GRID & CARDS */
.container { max-width:1200px; margin:0 auto; padding:0 20px; }
.grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:24px; padding-bottom:60px; }
.tool-card { background:var(--card-bg); border:var(--border); padding:24px; border-radius:20px; cursor:pointer; transition:all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); display:flex; align-items:center; gap:20px; position:relative; overflow:hidden; }
body.light-mode .tool-card { box-shadow:var(--shadow); }
.tool-card:hover { transform:translateY(-6px); border-color:var(--primary); box-shadow:0 12px 30px rgba(0,0,0,0.1); }

.card-icon { width:56px; height:56px; border-radius:16px; display:grid; place-items:center; font-size:1.6rem; flex-shrink:0; transition:0.3s; }
.tool-card:hover .card-icon { transform:scale(1.1) rotate(5deg); }
.green-glow { background:rgba(16,185,129,0.1); color:#10b981; }
.orange-glow { background:rgba(245,158,11,0.1); color:#f59e0b; }
.blue-glow { background:rgba(59,130,246,0.1); color:#3b82f6; }
.purple-glow { background:rgba(139,92,246,0.1); color:#8b5cf6; }
.red-glow { background:rgba(239,68,68,0.1); color:#ef4444; }
.pink-glow { background:rgba(236,72,153,0.1); color:#ec4899; }

.card-meta h3 { font-size:1.1rem; font-weight:600; margin-bottom:4px; }
.card-meta p { font-size:0.9rem; color:var(--text-muted); }
.action-icon { margin-left:auto; opacity:0; transform:translateX(-10px); transition:0.3s; color:var(--primary); }
.tool-card:hover .action-icon { opacity:1; transform:translateX(0); }

/* WORKSPACE LAYOUT */
.tool-workspace { padding:40px 0; min-height:85vh; animation:fadeIn 0.4s ease-out; }
.tool-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:30px; }
.back-btn { background:transparent; border:1px solid var(--border); color:var(--text); padding:8px 18px; border-radius:30px; cursor:pointer; font-weight:500; transition:0.3s; }
.back-btn:hover { border-color:var(--primary); color:var(--primary); }

.workspace-grid { display:grid; grid-template-columns:320px 1fr; gap:30px; }
.workspace-center { max-width:600px; margin:0 auto; text-align:center; }
.sidebar { background:var(--card-bg); padding:25px; border-radius:20px; border:var(--border); height:fit-content; }
body.light-mode .sidebar { box-shadow:var(--shadow); }

/* COMPONENTS */
.upload-zone { border:2px dashed var(--border); padding:30px; text-align:center; border-radius:16px; cursor:pointer; transition:0.3s; background:var(--surface); }
.upload-zone:hover { border-color:var(--primary); background:rgba(99,102,241,0.05); }
.upload-zone i { font-size:2.5rem; color:var(--primary); margin-bottom:10px; display:block; }
.upload-zone input { display:none; }

.std-input { width:100%; padding:12px; background:var(--bg); border:var(--border); color:var(--text); border-radius:10px; outline:none; transition:0.3s; }
.std-input:focus { border-color:var(--primary); }
.options { margin-top:20px; }
.options label { display:block; font-size:0.9rem; margin-bottom:8px; color:var(--text-muted); font-weight:600; }
.check-opt { margin-top:15px; display:flex; align-items:center; gap:10px; font-size:0.9rem; }

.btn-primary { width:100%; padding:14px; background:var(--primary); color:white; border:none; border-radius:12px; font-weight:600; cursor:pointer; margin-top:25px; transition:0.2s; box-shadow:0 4px 15px rgba(99,102,241,0.3); }
.btn-primary:hover { transform:translateY(-2px); filter:brightness(1.1); }
.mt-20 { margin-top:20px; }

/* PREVIEW AREAS */
.paper-canvas { background:#fff; border-radius:8px; overflow:hidden; min-height:600px; border:1px solid #e5e7eb; position:relative; }
.excel-render { width:100%; overflow:auto; max-height:600px; color:#000; }
.excel-render table { width:100%; border-collapse:collapse; font-family:Arial; font-size:11px; }
.excel-render th, td { border:1px solid #ccc; padding:8px; white-space:nowrap; }
.excel-render th { background:#f3f4f6; font-weight:bold; }
.placeholder { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:#9ca3af; }

.ai-panel { background:rgba(99,102,241,0.08); border:1px solid var(--primary); padding:15px; border-radius:12px; margin-bottom:20px; }
.ai-title { font-weight:700; color:var(--primary); margin-bottom:10px; }
.ai-panel ul { list-style:none; display:grid; grid-template-columns:repeat(auto-fit, minmax(140px, 1fr)); gap:10px; }
.ai-panel li { background:var(--bg); padding:8px 12px; border-radius:8px; font-size:0.85rem; border:var(--border); }

/* IMAGE & SUM UI */
.compare-view { display:grid; grid-template-columns:1fr 1fr; gap:20px; }
.img-box { background:var(--card-bg); padding:15px; border-radius:12px; border:var(--border); text-align:center; }
.img-box img { max-width:100%; height:auto; max-height:400px; object-fit:contain; margin-top:10px; border-radius:8px; }
.tag { font-size:0.75rem; padding:2px 8px; border-radius:4px; background:var(--surface); text-transform:uppercase; font-weight:700; letter-spacing:0.5px; }
.tag.highlight { background:var(--primary); color:white; }

.result-stats { background:var(--card-bg); border:var(--border); padding:25px; border-radius:16px; margin-top:30px; text-align:center; }
.stat-main h3 { font-size:3rem; color:#10b981; margin:5px 0 15px; }
.stat-sub { display:flex; justify-content:center; gap:30px; color:var(--text-muted); }

/* FOOTER */
footer { text-align:center; padding:40px; border-top:var(--border); margin-top:80px; color:var(--text-muted); font-size:0.9rem; }
.links a { margin:0 10px; color:var(--text); text-decoration:none; }

/* LOADING & TOAST */
#loading-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.8); backdrop-filter:blur(5px); z-index:9999; display:flex; justify-content:center; align-items:center; }
.glass-loader { text-align:center; color:white; }
.spinner { width:45px; height:45px; border:4px solid rgba(255,255,255,0.2); border-top-color:var(--primary); border-radius:50%; animation:spin 0.8s linear infinite; margin:0 auto 15px; }
@keyframes spin { 100%{transform:rotate(360deg)} }
#toast-container { position:fixed; top:20px; right:20px; z-index:10000; }
.toast { background:var(--card-bg); border-left:4px solid var(--primary); padding:15px 20px; border-radius:8px; margin-bottom:10px; box-shadow:0 10px 30px rgba(0,0,0,0.2); animation:slideIn 0.3s; display:flex; align-items:center; gap:10px; color:var(--text); border:1px solid var(--border); }
@keyframes slideIn { from{transform:translateX(100%)} to{transform:translateX(0)} }

@media(max-width:900px) { .workspace-grid { grid-template-columns:1fr; } .compare-view { grid-template-columns:1fr; } }

