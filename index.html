<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="ToolMaster AI V35.0 - Ultimate Web Suite. Features: Excel to PDF, Resume Maker, Magic Eraser, Text to Speech, and more. Privacy First.">
    <title>ToolMaster AI - Apex V35.0</title>
    
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';</script>
</head>
<body>

    <div class="mesh-background"></div>
    <div id="toast-container"></div>
    
    <div id="loading-overlay" class="hidden">
        <div class="loader-content">
            <div class="spinner"></div>
            <p id="loading-text">AI Working...</p>
        </div>
    </div>

    <nav class="navbar">
        <div class="container nav-inner">
            <div class="brand" onclick="showHome()">
                <div class="logo-icon"><i class="ri-sparkling-2-line"></i></div>
                <span class="brand-name">ToolMaster<span class="dot">.ai</span></span>
            </div>
            <div class="nav-links">
                <button class="theme-toggle-btn" onclick="toggleTheme()" aria-label="Toggle Theme">
                    <i class="ri-moon-line" id="theme-icon"></i>
                </button>
            </div>
        </div>
    </nav>

    <main id="home-page" class="fade-in">
        <header class="hero-section">
            <div class="container">
                <span class="badge-pill">‚ú® V35.0 Apex Release</span>
                <h1 class="hero-title">Privacy First AI Suite <br> <span class="gradient-text">Local Processing</span></h1>
                
                <div class="smart-search-wrapper">
                    <div class="search-box">
                        <i class="ri-search-line search-icon"></i>
                        <input type="text" id="search-bar" placeholder="Search tools (e.g. PDF, Speech, Remove BG)..." onkeyup="filterTools()" autocomplete="off">
                    </div>
                </div>
            </div>
        </header>

        <section class="container tool-grid-section">
            <div class="grid" id="tools-grid">
                
                <div class="tool-card" onclick="openTool('excel-tool')">
                    <div class="card-icon icon-excel"><i class="ri-file-excel-2-line"></i></div>
                    <div class="card-info"><h3>Excel to PDF</h3><p>Smart A4 Fit & Borders.</p></div>
                </div>

                <div class="tool-card" onclick="openTool('text-speech-tool')">
                    <div class="card-icon icon-speaker"><i class="ri-volume-up-line"></i></div>
                    <div class="card-info"><h3>Text to Speech</h3><p>AI Robot Voice Reader.</p></div>
                </div>

                <div class="tool-card" onclick="openTool('bg-remover-tool')">
                    <div class="card-icon icon-magic"><i class="ri-magic-line"></i></div>
                    <div class="card-info"><h3>Magic Eraser</h3><p>Remove Background.</p></div>
                </div>

                <div class="tool-card" onclick="openTool('resume-tool')">
                    <div class="card-icon icon-resume"><i class="ri-profile-line"></i></div>
                    <div class="card-info"><h3>Resume Maker</h3><p>Instant Professional CV.</p></div>
                </div>

                <div class="tool-card" onclick="openTool('img-tool')">
                    <div class="card-icon icon-zip"><i class="ri-file-zip-line"></i></div>
                    <div class="card-info"><h3>Compressor</h3><p>Reduce Image Size.</p></div>
                </div>

                <div class="tool-card" onclick="openTool('pdf-excel-tool')">
                    <div class="card-icon icon-table"><i class="ri-table-line"></i></div>
                    <div class="card-info"><h3>PDF to Excel</h3><p>Smart Row Extraction.</p></div>
                </div>

                <div class="tool-card" onclick="openTool('speech-tool')">
                    <div class="card-icon icon-mic"><i class="ri-mic-2-line"></i></div>
                    <div class="card-info"><h3>Voice Type</h3><p>Dictate Notes (Eng/Hin).</p></div>
                </div>

                <div class="tool-card" onclick="openTool('pdf-jpg-tool')">
                    <div class="card-icon icon-pdfimg"><i class="ri-image-2-line"></i></div>
                    <div class="card-info"><h3>PDF to JPG</h3><p>Convert Pages to HD.</p></div>
                </div>

                <div class="tool-card" onclick="openTool('jpg-pdf-tool')">
                    <div class="card-icon icon-imgpdf"><i class="ri-file-pdf-line"></i></div>
                    <div class="card-info"><h3>JPG to PDF</h3><p>Merge Images.</p></div>
                </div>

                <div class="tool-card" onclick="openTool('photo-qr-tool')">
                    <div class="card-icon icon-qr"><i class="ri-qr-code-line"></i></div>
                    <div class="card-info"><h3>Photo to QR</h3><p>Cloud Link Gen.</p></div>
                </div>

                <div class="tool-card" onclick="openTool('pass-tool')">
                    <div class="card-icon icon-key"><i class="ri-shield-key-line"></i></div>
                    <div class="card-info"><h3>Secure Gen</h3><p>Safe Passwords.</p></div>
                </div>

            </div>
        </section>
    </main>

    <div id="excel-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Excel to PDF</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('excel-input').click()"><i class="ri-file-excel-2-line"></i><p>Upload Excel</p><input type="file" id="excel-input" accept=".xlsx, .xls"></div>
                <div class="control-group"><label>Orientation</label><select id="pdf-orient" class="custom-select"><option value="auto">ü§ñ AI Auto-Detect</option><option value="landscape">Landscape</option><option value="portrait">Portrait</option></select></div>
                <button class="action-btn" onclick="generateUltraHDPDF()">Download PDF (Smart Fit)</button>
            </div>
            <div class="main-panel">
                <div id="export-container" class="preview-canvas"><div id="excel-preview-container" class="excel-content"><div class="empty-state">Preview will load here...</div></div></div>
            </div>
        </div>
    </div>

    <div id="text-speech-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>AI Text Reader</h2></div>
        <div class="center-panel bordered-dashboard" style="max-width: 700px;">
            <textarea id="tts-input" class="speech-area" placeholder="Paste text here to listen (English, Hindi, etc)..."></textarea>
            <div class="control-group mt-4" style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; text-align:left;">
                <div><label>Select Voice</label><select id="voice-select" class="custom-select"></select></div>
                <div><label>Speed: <span id="rate-val">1x</span></label><input type="range" id="rate" min="0.5" max="2" value="1" step="0.1" oninput="document.getElementById('rate-val').innerText=this.value+'x'"></div>
            </div>
            <div class="action-row mt-4" style="display:flex; gap:15px; justify-content:center;">
                <button class="action-btn" onclick="speakText()"><i class="ri-play-fill"></i> Play Audio</button>
                <button class="action-btn secondary" onclick="stopSpeech()" style="background:#ef4444;"><i class="ri-stop-fill"></i> Stop</button>
            </div>
        </div>
    </div>

    <div id="bg-remover-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Magic Eraser</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('bg-input').click()"><i class="ri-upload-cloud-2-line"></i><p>Upload Photo</p><input type="file" id="bg-input" accept="image/png, image/jpeg"></div>
                <div class="control-group mt-4">
                    <h4>Background</h4>
                    <div class="color-grid">
                        <button class="color-btn transparent active" onclick="changeBg('transparent')"></button>
                        <button class="color-btn white" onclick="changeBg('#ffffff')"></button>
                        <button class="color-btn black" onclick="changeBg('#000000')"></button>
                        <input type="color" id="bg-color-picker" value="#007bff" oninput="changeBg(this.value)">
                    </div>
                </div>
                <button class="action-btn" id="dl-bg-btn" disabled>Download HD PNG</button>
            </div>
            <div class="main-panel">
                <div id="bg-processing" class="hidden state-msg"><div class="spinner"></div><p>AI Removing Background...</p></div>
                <div id="bg-empty-state" class="empty-state"><i class="ri-magic-fill" style="font-size:3rem; opacity:0.3;"></i><p>Upload Image</p></div>
                <div id="compare-container" class="compare-container hidden">
                    <div class="img-layer base-layer" id="bg-result-layer"><img id="bg-result-img" src=""></div>
                    <div class="img-layer overlay-layer" id="bg-overlay-layer"><img id="bg-original-img" src=""></div>
                    <div class="slider-handle" id="slider-handle"><div class="handle-line"></div><div class="handle-circle"><i class="ri-arrow-left-right-line"></i></div></div>
                </div>
            </div>
        </div>
    </div>

    <div id="resume-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Resume Builder</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel" style="max-height: 80vh; overflow-y: auto;">
                <h4>Details</h4>
                <input type="text" class="custom-input" placeholder="Full Name" oninput="updateResume('name', this.value)">
                <input type="text" class="custom-input" placeholder="Job Title" oninput="updateResume('title', this.value)">
                <input type="text" class="custom-input" placeholder="Phone" oninput="updateResume('phone', this.value)">
                <input type="text" class="custom-input" placeholder="Email" oninput="updateResume('email', this.value)">
                <h4 class="mt-4">Summary</h4>
                <textarea class="custom-input" rows="3" placeholder="Summary..." oninput="updateResume('summary', this.value)"></textarea>
                <h4 class="mt-4">Skills (Comma separated)</h4>
                <input type="text" class="custom-input" placeholder="HTML, CSS, JS..." oninput="updateResume('skills', this.value)">
                <button class="action-btn mt-4" onclick="downloadResumePDF()">Download Resume PDF</button>
            </div>
            <div class="main-panel" style="background: #333; display: flex; justify-content: center; padding: 20px; overflow: auto;">
                <div id="resume-preview" class="resume-a4">
                    <div class="res-header"><h1 id="res-name">Your Name</h1><p id="res-title">Professional Title</p></div>
                    <div class="res-body">
                        <div class="res-section"><div class="res-contact"><span id="res-phone">+91 0000000000</span> | <span id="res-email">email@example.com</span></div></div>
                        <div class="res-section"><h3>Profile</h3><p id="res-summary">Your professional summary...</p></div>
                        <div class="res-section"><h3>Skills</h3><div id="res-skills" class="skills-grid"></div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="img-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Compressor</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('img-input').click()"><i class="ri-image-edit-line"></i><p>Upload Image</p><input type="file" id="img-input" accept="image/*"></div>
                <div class="control-group"><label>Quality: <span id="q-val">80%</span></label><input type="range" id="quality" min="0.1" max="1" step="0.05" value="0.8" oninput="liveCompress()"></div>
                <button class="action-btn" id="dl-img-btn" disabled>Download Compressed</button>
            </div>
            <div class="main-panel">
                <div class="image-compare">
                    <div class="img-container"><span class="label">Original: <b id="orig-size-display">0 KB</b></span><img id="orig-prev" src=""></div>
                    <div class="img-container result"><span class="label highlight">Result: <b id="comp-size-display">0 KB</b></span><img id="comp-prev" src=""></div>
                </div>
            </div>
        </div>
    </div>

    <div id="pdf-excel-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>PDF to Excel</h2></div>
        <div class="center-panel bordered-dashboard">
            <div class="upload-box large" onclick="document.getElementById('pdf-to-ex-input').click()"><i class="ri-file-text-line"></i><p>Drop PDF</p><input type="file" id="pdf-to-ex-input" accept=".pdf"></div>
            <button class="action-btn mt-4" onclick="convertPDFtoExcel()">Extract & Download</button>
        </div>
    </div>

    <div id="speech-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Voice Typer</h2></div>
        <div class="center-panel bordered-dashboard" style="max-width: 800px;">
            <div class="speech-controls">
                <select id="speech-lang" class="custom-select" style="width: auto;">
                    <option value="en-US">English (US)</option><option value="en-IN">English (India)</option><option value="hi-IN">Hindi (India)</option>
                </select>
                <button id="mic-btn" class="mic-btn" onclick="toggleSpeech()"><i class="ri-mic-line"></i></button>
                <span id="mic-status">Click Mic</span>
            </div>
            <textarea id="speech-output" class="speech-area" placeholder="Start speaking..."></textarea>
            <div class="action-row mt-4" style="display:flex; gap:10px; justify-content:center;">
                <button class="action-btn" onclick="copySpeech()">Copy</button><button class="action-btn" onclick="saveTextAsDoc()">Download</button>
            </div>
        </div>
    </div>

    <div id="pdf-jpg-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>PDF to JPG</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('pdf-jpg-input').click()"><i class="ri-pages-line"></i><p>Select PDF</p><input type="file" id="pdf-jpg-input" accept=".pdf"></div>
                <button class="action-btn" onclick="convertPdfToJpg()">Convert All Pages</button>
            </div>
            <div class="main-panel"><div id="jpg-preview-grid" class="image-grid-preview"><div class="empty-state">Pages will appear here</div></div></div>
        </div>
    </div>

    <div id="jpg-pdf-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>JPG to PDF</h2></div>
        <div class="center-panel bordered-dashboard">
            <div class="upload-box large" onclick="document.getElementById('jpg-input').click()"><i class="ri-gallery-upload-fill"></i><p>Select Multiple Images</p><input type="file" id="jpg-input" multiple accept="image/*"></div>
            <button class="action-btn mt-4" onclick="convertJpgToPdf()">Merge & Download PDF</button>
        </div>
    </div>

    <div id="photo-qr-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Photo to QR</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('qr-img-input').click()"><i class="ri-share-forward-2-line"></i><p>Upload Photo</p><input type="file" id="qr-img-input" accept="image/*"></div>
                <button class="action-btn" id="gen-qr-btn" disabled>Generate Link</button>
            </div>
            <div class="main-panel center-panel">
                <div id="qr-loading" class="hidden state-msg"><div class="spinner"></div><p>Uploading...</p></div>
                <div id="qr-result-box" class="hidden text-center">
                    <div id="qrcode" style="display:inline-block; padding:15px; background:white; border-radius:10px; margin-bottom:15px;"></div>
                    <div style="display:flex; gap:10px;"><input type="text" id="img-share-link" class="custom-select" readonly><button class="action-btn" style="width:auto; margin:0;" onclick="copyLink()">Copy</button></div>
                </div>
                <div id="qr-empty" class="empty-state"><p>QR Code will appear here</p></div>
            </div>
        </div>
    </div>

    <div id="pass-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Secure Gen</h2></div>
        <div class="center-panel bordered-dashboard">
            <div class="pass-display" id="generated-pass" onclick="copyPass()">CLICK GENERATE</div>
            <div class="control-group" style="max-width:400px; margin:20px auto;"><label>Length: <span id="len-val">16</span></label><input type="range" id="pass-len" min="8" max="64" value="16" oninput="document.getElementById('len-val').innerText=this.value"></div>
            <button class="action-btn" onclick="generatePass()">Generate Key</button>
        </div>
    </div>

    <div id="privacy-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn" onclick="closePrivacy()">&times;</span>
            <h2>Privacy & Security</h2>
            <p>Your privacy is our priority. All image processing happens locally.</p>
            <button class="action-btn mt-2" onclick="closePrivacy()">Close</button>
        </div>
    </div>

    <footer>
        <div class="container footer-content">
            <div class="footer-left"><h4>ToolMaster.ai</h4><p>Version 35.0 (Apex)</p></div>
            <div class="footer-bottom"><p>Developed by <b>Swapan</b> ‚Ä¢ <a href="#" onclick="document.getElementById('privacy-modal').classList.remove('hidden')">Privacy</a></p></div>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
