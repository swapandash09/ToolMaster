<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToolMaster V35.0 - Apex AI Final Release</title>
    
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@imgly/background-removal@1.5.5/+esm"></script>

    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';</script>
</head>
<body>

    <div class="mesh-background"></div>
    <div id="toast-container"></div>
    <div id="loading-overlay" class="hidden">
        <div class="loader-content">
            <div class="spinner"></div>
            <p id="loading-text">AI Working...</p>
        </div>
    </div>

    <nav class="navbar">
        <div class="container nav-inner">
            <div class="brand" onclick="showHome()">
                <div class="logo-icon"><i class="ri-sparkling-2-line"></i></div>
                <span class="brand-name">ToolMaster<span class="dot">.ai</span></span>
            </div>
            <div class="nav-links">
                <button class="theme-toggle-btn" onclick="toggleTheme()" title="Toggle Theme">
                    <i class="ri-moon-line" id="theme-icon"></i>
                </button>
            </div>
        </div>
    </nav>

    <main id="home-page" class="fade-in">
        <header class="hero-section">
            <div class="container">
                <span class="badge-pill">‚ú® V35.0 Apex AI Final Release</span>
                <h1 class="hero-title">Powerful AI Tool Suite <br> <span class="gradient-text">Ultimate Fidelity</span></h1>
                
                <div class="smart-search-wrapper">
                    <div class="search-box">
                        <i class="ri-search-line search-icon"></i>
                        <input type="text" id="search-bar" placeholder="Search (e.g. Excel, Compressor, Magic)..." onkeyup="filterTools()" autocomplete="off">
                    </div>
                </div>
            </div>
        </header>

        <section class="container tool-grid-section">
            <div class="grid" id="tools-grid">
                
                <div class="tool-card" onclick="openTool('excel-tool')">
                    <div class="card-icon icon-excel"><i class="ri-file-excel-2-line"></i></div>
                    <div class="card-info"><h3>Excel to PDF</h3><p>Hyper Fidelity & Auto-Scale Bot.</p></div>
                    <div class="hover-arrow"><i class="ri-arrow-right-line"></i></div>
                </div>

                <div class="tool-card" onclick="openTool('img-tool')">
                    <div class="card-icon icon-zip"><i class="ri-tools-line"></i></div>
                    <div class="card-info"><h3>Compressor</h3><p>AI Ratio Lock & Live Preview.</p></div>
                    <div class="hover-arrow"><i class="ri-arrow-right-line"></i></div>
                </div>

                <div class="tool-card" onclick="openTool('bg-remover-tool')">
                    <div class="card-icon icon-magic"><i class="ri-focus-3-line"></i></div>
                    <div class="card-info"><h3>Magic Eraser</h3><p>100% Erase Fidelity & Colors.</p></div>
                    <div class="hover-arrow"><i class="ri-arrow-right-line"></i></div>
                </div>
                
                <div class="tool-card" onclick="openTool('pdf-excel-tool')">
                    <div class="card-icon icon-table"><i class="ri-layout-row-line"></i></div>
                    <div class="card-info"><h3>PDF to Excel</h3><p>Deep Table Extract Bot.</p></div>
                    <div class="hover-arrow"><i class="ri-arrow-right-line"></i></div>
                </div>

                <div class="tool-card" onclick="openTool('photo-qr-tool')">
                    <div class="card-icon icon-qr"><i class="ri-share-line"></i></div>
                    <div class="card-info"><h3>Photo to QR</h3><p>AI Cloud Share Link.</p></div>
                    <div class="hover-arrow"><i class="ri-arrow-right-line"></i></div>
                </div>

                <div class="tool-card" onclick="openTool('pdf-jpg-tool')">
                    <div class="card-icon icon-pdfimg"><i class="ri-image-2-line"></i></div>
                    <div class="card-info"><h3>PDF to JPG</h3><p>High Res Page Converter.</p></div>
                    <div class="hover-arrow"><i class="ri-arrow-right-line"></i></div>
                </div>

                <div class="tool-card" onclick="openTool('jpg-pdf-tool')">
                    <div class="card-icon icon-imgpdf"><i class="ri-file-image-line"></i></div>
                    <div class="card-info"><h3>JPG to PDF</h3><p>AI Smart Fit Layout.</p></div>
                    <div class="hover-arrow"><i class="ri-arrow-right-line"></i></div>
                </div>

                <div class="tool-card" onclick="openTool('pass-tool')">
                    <div class="card-icon icon-key"><i class="ri-lock-2-line"></i></div>
                    <div class="card-info"><h3>Secure Gen</h3><p>Strong Key Generator.</p></div>
                    <div class="hover-arrow"><i class="ri-arrow-right-line"></i></div>
                </div>
            </div>
        </section>
    </main>

    <div id="bg-remover-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Magic Eraser</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('bg-input').click()"><i class="ri-focus-3-line"></i><p>Upload Photo</p><input type="file" id="bg-input" accept="image/*"></div>
                
                <div class="control-group mt-4">
                    <h4>Customer Options</h4>
                    <label>Background Color</label>
                    <div class="color-grid">
                        <button class="color-btn transparent active" onclick="changeBg('transparent')"></button>
                        <button class="color-btn white" onclick="changeBg('#ffffff')"></button>
                        <button class="color-btn black" onclick="changeBg('#000000')"></button>
                        <input type="color" id="bg-color-picker" value="#007bff" oninput="changeBg(this.value)">
                    </div>
                </div>
                <button class="action-btn" id="dl-bg-btn" disabled>Download PNG</button>
            </div>
            <div class="main-panel">
                <div id="bg-processing" class="hidden state-msg"><div class="spinner"></div><p>AI Removing Background...</p></div>
                <div id="bg-empty-state" class="empty-state"><i class="ri-image-add-line" style="font-size:3rem; opacity:0.5;"></i><p>Upload Image</p></div>
                
                <div id="compare-container" class="compare-container hidden">
                    <div class="img-layer base-layer" id="bg-result-layer"><img id="bg-result-img" src=""></div>
                    <div class="img-layer overlay-layer" id="bg-overlay-layer"><img id="bg-original-img" src=""></div>
                    <div class="slider-handle" id="slider-handle"><div class="handle-line"></div><div class="handle-circle"><i class="ri-arrow-left-right-line"></i></div></div>
                </div>
            </div>
        </div>
    </div>


    <div id="excel-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Excel to PDF</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('excel-input').click()"><i class="ri-file-excel-2-line"></i><p>Drop Excel</p><input type="file" id="excel-input" accept=".xlsx, .xls"></div>
                <div class="control-group"><label>Layout</label><select id="pdf-orient" class="custom-select"><option value="auto">ü§ñ AI Auto-Detect</option><option value="landscape">Landscape</option><option value="portrait">Portrait</option></select></div>
                <div class="control-group mt-4"><input type="checkbox" id="auto-fit" checked> <label>ü§ñ AI Auto-Scale (Full Page)</label></div>
                <button class="action-btn" onclick="generateUltraHDPDF()">Generate PDF</button>
            </div>
            <div class="main-panel">
                <div id="export-container" class="preview-canvas">
                    <div id="excel-preview-container" class="excel-content">
                        <div class="empty-state">Preview...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="img-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Back</button><h2>Compressor</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('img-input').click()"><i class="ri-image-line"></i><p>Drop Image</p><input type="file" id="img-input" accept="image/*"></div>
                <div class="control-group"><label>Mode</label><select id="comp-mode" class="custom-select" onchange="toggleSizeInput()"><option value="quality">Quality %</option><option value="target">Target KB</option></select></div>
                <div class="control-group" id="quality-wrapper"><label>Quality: <span id="q-val">80%</span></label><input type="range" id="quality" min="0.1" max="1" step="0.05" value="0.8" oninput="liveCompress()"></div>
                <div class="control-group hidden" id="target-wrapper"><label>Max KB</label><input type="number" id="target-kb" class="custom-select" placeholder="e.g. 50"></div>
                <button class="action-btn" id="dl-img-btn" disabled>Download</button>
            </div>
            <div class="main-panel">
                <div class="image-compare">
                    <div class="img-container">
                        <span class="label">Original: <b id="orig-size-display">0 KB</b></span>
                        <img id="orig-prev" src="" alt="Original Image">
                    </div>
                    <div class="img-container result">
                        <span class="label highlight">Result: <b id="comp-size-display">0 KB</b></span>
                        <img id="comp-prev" src="" alt="Compressed Image">
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="pdf-excel-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>PDF to Excel</h2></div>
        <div class="center-panel bordered-dashboard">
            <div class="upload-box large" onclick="document.getElementById('pdf-to-ex-input').click()"><i class="ri-file-pdf-line"></i><p>Drop PDF</p><input type="file" id="pdf-to-ex-input" accept=".pdf"></div>
            <button class="action-btn mt-4" onclick="convertPDFtoExcel()">Start Extraction</button>
        </div>
    </div>
    <div id="pdf-jpg-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>PDF to JPG</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('pdf-jpg-input').click()"><i class="ri-image-line"></i><p>Drop PDF</p><input type="file" id="pdf-jpg-input" accept=".pdf"></div>
                <div class="control-group mt-4"><label>Quality: <span id="jpg-qual-val">High (100%)</span></label><input type="range" id="jpg-quality" min="0.1" max="1" step="0.1" value="1.0" oninput="updateJpgQualityLabel(this.value)"></div>
                <button class="action-btn" onclick="convertPdfToJpg()">Convert All Pages</button>
            </div>
            <div class="main-panel"><div id="jpg-preview-grid" class="image-grid-preview"><div class="empty-state">Pages will appear here...</div></div></div>
        </div>
    </div>
    <div id="jpg-pdf-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>JPG to PDF</h2></div>
        <div class="center-panel bordered-dashboard">
            <div class="upload-box large" onclick="document.getElementById('jpg-input').click()"><i class="ri-gallery-upload-line"></i><p>Drop Images</p><input type="file" id="jpg-input" multiple accept="image/*"></div>
            <div class="control-group mt-4 text-center"><input type="checkbox" id="ai-fit-pdf" checked> <label>ü§ñ AI Smart Fit</label></div>
            <button class="action-btn mt-4" onclick="convertJpgToPdf()">Create PDF</button>
        </div>
    </div>
    <div id="photo-qr-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Photo to QR</h2></div>
        <div class="split-layout">
            <div class="sidebar-panel">
                <div class="upload-box" onclick="document.getElementById('qr-img-input').click()"><i class="ri-share-forward-line"></i><p>Upload Photo</p><input type="file" id="qr-img-input" accept="image/*"></div>
                <button class="action-btn" id="gen-qr-btn" disabled>Generate QR</button>
            </div>
            <div class="main-panel center-panel">
                <div id="qr-loading" class="hidden state-msg"><div class="spinner"></div><p>Generating Link...</p></div>
                <div id="qr-result-box" class="hidden text-center">
                    <div id="qrcode" style="display:inline-block; padding:15px; background:white; border-radius:10px;"></div>
                    <input type="text" id="img-share-link" class="custom-select mt-4" readonly>
                    <button class="action-btn mt-2" onclick="copyLink()">Copy Link</button>
                </div>
                <div id="qr-empty" class="empty-state"><i class="ri-qr-scan-2-line" style="font-size:3rem; opacity:0.5;"></i><p>QR will appear here</p></div>
            </div>
        </div>
    </div>
    <div id="pass-tool" class="tool-workspace hidden container">
        <div class="workspace-header"><button class="back-btn" onclick="showHome()">‚Üê Dashboard</button><h2>Secure Gen</h2></div>
        <div class="center-panel bordered-dashboard">
            <div class="pass-display" id="generated-pass" onclick="copyPass()">CLICK GENERATE</div>
            <div class="control-group" style="max-width:400px; margin:20px auto;"><label>Length</label><input type="range" id="pass-len" min="8" max="64" value="16"></div>
            <button class="action-btn" onclick="generatePass()">Generate</button>
        </div>
    </div>
    
    <div id="privacy-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn" onclick="closePrivacy()">&times;</span>
            <h2>Privacy & Terms</h2>
            <p>Developer by Swapan. All processing is done locally in your browser.</p>
            <button class="action-btn mt-2" onclick="closePrivacy()">Close</button>
        </div>
    </div>


    <footer>
        <div class="container footer-content">
            <div class="footer-left"><h4>ToolMaster.ai</h4><p>Ultimate Suite V10.</p></div>
            <div class="footer-bottom"><p>Developer by <b>Swapan</b> ‚Ä¢ Made in India üáÆüá≥</p></div>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
                                                                                                                      </html>
